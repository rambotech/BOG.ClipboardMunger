<?xml version="1.0"?>
<ClipboardMungerScriptContainer xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Title>Filter with Line Number (Escaped)</Title>
  <Description>Clipboard contains lines with cr+lf delimiters.

User enters a string to act as a filter (URL Encoded).

Keeps only lines which have the string anywhere in the line, and prefixed each line with its line number.
</Description>
  <Script>// Take a tab+crlf delimited grid of data from clipboard.
// Prompt user for a string which acts as a filter.
// Keep only lines which have that string.

using System;
using System.Text;
using System.Windows.Forms;
using BOG.Framework;

public class Script : Interfaces.IClipboard
{
    public string Munge(string clipboardSource)
    {
    	int LineIndex = 0;
		StringBuilder result = new StringBuilder();
		string Filter = string.Empty;
		if (DialogResult.OK != BOG.Framework.FormEx.InputBox ("Filter", "Enter a URL-Encoded phrase which must exist in a line to keep it", ref Filter))
		{
			Filter = string.Empty;
		}
		Filter = System.Web.HttpUtility.UrlDecode(Filter);

		foreach (string ThisLine in clipboardSource.Split(new string[] { "\r\n" }, StringSplitOptions.None))
		{
			LineIndex ++;
			if (ThisLine.IndexOf (Filter) &gt;= 0)
			{
				result.AppendLine(string.Format("{0,-13:#,###,###,##0}: {1}", LineIndex, ThisLine));
			}
		}
		return result.ToString();
    }
}</Script>
  <Language>1</Language>
  <TestData>URI
http://www.myserver.com/page/30078708/
http://www.myserver.com/page/30084004/
http://www.myserver.com/page/30083627/
http://www.myserver.com/page/30083627/
http://www.myserver.com/page/30084074/

----- 8&lt; ---------------

Search String

30083
</TestData>
  <References>
    <string>System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</string>
    <string>System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a</string>
    <string>System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</string>
  </References>
  <OtherReferences>
    <string>C:\apps\Clipboard Munger\Framework.DLL</string>
  </OtherReferences>
</ClipboardMungerScriptContainer>